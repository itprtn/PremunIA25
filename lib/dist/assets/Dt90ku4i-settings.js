import{j as e}from"./dfWdBlna-chunk.js";import{r as s}from"./Dc2Emx3F-chunk.js";import{u as t,C as a,m as r,n as l,a as i,r as d,f as n,I as c,B as x,s as m,o,L as u}from"./lYxdVFoR.js";import{g as h,U as j,d as v,a as p,$ as g,n as N,w as f,x as b,a0 as w}from"./7YIM3tny-chunk.js";import{u as y}from"./DHnlrK-p-chunk.js";import"./BpqZfnrR-chunk.js";import"./Bo41tin1-chunk.js";function E({user:o,onSettingsUpdate:u}){var y;const{toast:E}=t(),[S,T]=s.useState(""),[P,k]=s.useState(!1),[C,M]=s.useState(null);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center space-x-2",children:[e.jsx(h,{className:"w-6 h-6"}),e.jsx("span",{children:"Paramètres du Système"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Configuration et tests du CRM"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{className:"rounded-2xl border-0 shadow-md hover:shadow-lg transition-all duration-300",children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{children:"Informations Utilisateur"})]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-sm text-muted-foreground",children:"Email"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(v,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:o.email}),e.jsx(n,{variant:"secondary",className:"rounded-full",children:"Vérifié"})]})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-sm text-muted-foreground",children:"Nom complet"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(j,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:(null==(y=o.user_metadata)?void 0:y.full_name)||"Non renseigné"})]})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-sm text-muted-foreground",children:"ID Utilisateur"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(p,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"font-mono text-xs bg-muted px-2 py-1 rounded",children:[o.id.substring(0,8),"..."]})]})]})]})]}),e.jsxs(a,{className:"rounded-2xl border-0 shadow-md hover:shadow-lg transition-all duration-300",children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(g,{className:"w-5 h-5"}),e.jsx("span",{children:"Test SMTP Brevo"})]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"testEmail",className:"text-sm font-medium",children:"Email de test"}),e.jsx(c,{id:"testEmail",type:"email",placeholder:"votre@email.com",value:S,onChange:e=>T(e.target.value),className:"mt-1 rounded-xl",disabled:P}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Un email de test sera envoyé via l'API Brevo (smtp-relay.brevo.com)"})]}),e.jsx(x,{onClick:async()=>{if(!S)return void E({title:"Email requis",description:"Veuillez saisir une adresse email de test",variant:"destructive"});if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S)){k(!0),M(null);try{const{data:e,error:s}=await m.functions.invoke("test-smtp",{body:{testEmail:S}});if(s)throw new Error(s.message);if(!(null==e?void 0:e.success))throw new Error((null==e?void 0:e.error)||"Erreur inconnue lors du test");M({success:!0,message:`Email de test envoyé avec succès à ${S}. Vérifiez votre boîte de réception.`}),E({title:"Test SMTP réussi ✅",description:`Email de test envoyé à ${S} via Brevo`})}catch(e){console.error("❌ Erreur test SMTP:",e),M({success:!1,message:`Échec du test SMTP: ${e.message}`}),E({title:"Erreur test SMTP ❌",description:e.message,variant:"destructive"})}finally{k(!1)}}else E({title:"Email invalide",description:"Veuillez saisir une adresse email valide",variant:"destructive"})},disabled:P||!S,className:"w-full rounded-xl",children:P?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}),"Test en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Envoyer email de test"]})}),C&&e.jsxs("div",{className:"p-3 rounded-xl border "+(C.success?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[C.success?e.jsx(f,{className:"w-4 h-4 text-green-600"}):e.jsx(b,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium",children:C.success?"Test réussi":"Test échoué"})]}),e.jsx("p",{className:"text-xs mt-1",children:C.message})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-xl",children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center space-x-2",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"Configuration Brevo Active"})]}),e.jsxs("div",{className:"space-y-1 text-xs text-muted-foreground",children:[e.jsx("div",{children:"• Serveur SMTP: smtp-relay.brevo.com:587"}),e.jsx("div",{children:"• Connexion: 694946002@smtp-brevo.com"}),e.jsx("div",{children:"• Expéditeur: info@premunia.com"}),e.jsx("div",{children:"• Limite journalière: 250 emails"}),e.jsx("div",{children:"• Suivi: Ouvertures et clics trackés"}),e.jsx("div",{children:"• API: Intégration Brevo REST API"})]})]})]})]})]}),e.jsxs(a,{className:"rounded-2xl border-0 shadow-md hover:shadow-lg transition-all duration-300",children:[e.jsx(r,{children:e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{children:"Statistiques Email"})]})}),e.jsx(i,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"98%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taux de livraison"}),e.jsx("p",{className:"text-xs text-blue-500 mt-1",children:"Via Brevo"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"24%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taux d'ouverture"}),e.jsx("p",{className:"text-xs text-green-500 mt-1",children:"Marketing"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"3.2%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Taux de clic"}),e.jsx("p",{className:"text-xs text-purple-500 mt-1",children:"Engagement"})]})]})})]})]})}function S(){const{user:t,loading:a}=o(),r=y();return s.useEffect(()=>{a||t||r("/login")},[t,a,r]),a||t?e.jsx(u,{title:"Paramètres",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex justify-between items-start mb-12",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-light text-slate-900 mb-2",children:"Paramètres"}),e.jsx("p",{className:"text-slate-600 text-base",children:"Configuration de votre compte"})]}),e.jsx("button",{className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Sauvegarder"})]}),e.jsx(E,{user:t,onSettingsUpdate:()=>{}})]})}):null}export{S as default};
